<header class="navbar navbar-fixed-top navbar-inverse custom-nav">
  <div class="container">
    <%= link_to t("logo.quiz"), root_path, id: "logo" %>
    <nav>
      <ul class="nav navbar-top-links navbar-right">
        <li>
          <%= link_to(root_path) do  %>
            <i class="fa fa-home"></i>
            Home
          <% end %>
        </li>
        <% if user_signed_in? %>
          <% if current_user %>
            <% @notifications = Notification.where(to: current_user.id).order("created_at DESC").take 3 %>
          <% end %>
          <% if current_user.admin? %>
            <li>
              <%= link_to admin_users_path, title: t("logo.users") do %>
                <i class="fa fa-users"></i>
                Users
              <% end %>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                <i class="fa fa-shopping-bag"></i> Category <i class="fa fa-caret-down"></i>
              </a>
              <ul class="dropdown-menu">
                <li>
                  <%= link_to admin_categories_path do %>
                    <i class="fa fa-shopping-bag"></i>
                    All Category
                  <% end %>
                </li>
                <li>
                  <%= link_to new_admin_category_path  do %>
                    <i class="fa fa-plus-square" aria-hidden="true"></i>
                    New Category
                  <% end %>
                </li>
              </ul>
              
            </li>
          <% end %>
          <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown" href="#">
              <i class="fa fa-envelope fa-fw"></i> Alert  <i class="fa fa-caret-down"></i>
            </a>
            <ul class="dropdown-menu dropdown-messages">
              <% if @notifications %>
                <% @notifications.each do |notice| %>
                  <li>
                    <a href="#">
                      <div>
                        <strong><%= User.find(notice.from).email %></strong>
                        <span class="pull-right text-muted">
                          <em><%= notice.created_at %></em>
                        </span>
                      </div>
                      <div><%= notice.content %></div>
                    </a>
                  </li>
                  <li class="divider"></li>
                <% end %>
                <li>
                  <%= link_to notifications_path, class: "text-center" do %>
                    <strong>Read All Messages</strong>
                    <i class="fa fa-angle-right"></i>
                  <% end %>
                </li>
              <% else %>
                <li>
                  <a class="text-center" href="#">
                    <strong>No Messages</strong>
                    <i class="fa fa-angle-right"></i>
                  </a>
                </li>
              <% end %>
            </ul>
          <li class="dropdown user user-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              <%= image_tag current_user.avatar.url ? 
                current_user.avatar.url : "no_avatar", size: "160x160", 
                class: "user-image", alt: "User Image" %>
              <span class="hidden-xs"><%= current_user.name %></span>
            </a>
            <ul class="dropdown-menu">
              <li>
                <%= link_to(profile_path)  do %>
                <i class="fa fa-user fa-fw"></i>
                Profile
                <% end %>
              </li>
              <li>
                <%= link_to(edit_user_registration_path) do %>
                <i class="fa fa-gear fa-fw"></i>
                Setting
                <% end %>
              </li>
              <li class="divider"></li>
              <li>
                <%= link_to(destroy_user_session_path,
                method: "delete") do %>
                <i class="fa fa-sign-out fa-fw"></i>
                <%= t "devise.log_out" %>
                <% end %>
              </li>
            </ul>
          </li>
        <% else %>
          <li>
            <button type="button" class="btn btn-danger">
              <%= link_to t("devise.sign_up"), new_user_registration_path %>
            </button>
            <button type="button" class="btn btn-danger">
              <%= link_to  new_user_session_path  do %>
                <i class="fa fa-user" aria-hidden="true"></i>
                <%= t "devise.log_in" %>
              <% end %>
            </button>
          </li>
        <% end %>
      </ul>
    </nav>
  </div>
</header>
